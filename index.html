<!DOCTYPE html>
<html lang="be">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Беларуская лакалізацыя</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat+Alternates:wght@400;700&display=swap" rel="stylesheet">

  <style>
    body{
      background-color:#111111;
      color:#eeeeee;
      font-family:'Montserrat Alternates', sans-serif;
      margin:0; padding:0;
    }

    .top-bar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:20px;
      margin-right:30px;
      font-weight:700;
      font-size:18px;
    }
    .logo{
      color:#A9FF8E;
      font-size:32px;
      font-weight:1000;
      margin:0px 10px 0px 40px;
    }
    nav{ display:flex; gap:30px; margin:0; }
    nav a{ color:#A9FF8E; text-decoration:none; }

    .header-container{ display:flex; justify-content:space-between; align-items:flex-start; padding:0; }
    .header-alignment{
      width:85%;
      max-width:1500px;
      margin:20px auto;
      padding:30px;
      display:flex;
      align-items:center;
      gap:20px;
    }
    .header-left{ flex:1; }
    .main-title{ font-size:48px; color:#A9FF8E; margin:20px 0 10px 0; font-weight:700; }
    .subtitle{ font-size:16px; margin:0; max-width:600px; }
    .header-right{ text-align:center; margin-left:20px; margin-top:30px; }
    .header-right span{ display:block; color:#A9FF8E; font-size:16px; }
    .header-right .game-name{ text-align:center; font-size:18px; color:#eeeeee; margin:10px 0; }

    .game-button{
      background-color:#A9FF8E;
      color:#111111;
      padding:8px 16px;
      text-decoration:none;
      border-radius:7px;
      display:inline-block;
      font-size:14px;
      cursor:pointer;
      user-select:none;
      border:0;
    }

    .game-section{ padding:20px; transition:filter 0.3s ease; }
    .game-card{
      background-color:#161d16;
      width:85%;
      max-width:1500px;
      margin:20px auto;
      padding:30px;
      display:flex;
      align-items:center;
      gap:20px;
      border-radius:10px;
      transition:filter 0.3s ease;
      cursor:pointer;
    }
    .game-card:hover{ filter:brightness(0.85); }
    .game-card img{ max-width:200px; height:auto; border-radius:10px; }
    .game-info{ flex:1; display:flex; flex-direction:column; }
    .game-title{ font-size:24px; color:#A9FF8E; margin:0 0 10px 0; font-weight:700; }
    .game-platforms{ font-size:12px; color:#A9FF8E; margin:0 0 10px 0; }
    .game-desc{ font-size:14px; color:#eeeeee; margin:0; max-width:900px; }
    .button-container{ align-self:center; margin-left:auto; }

    footer{
      display:flex;
      justify-content:space-around;
      padding:20px;
      background-color:#0E120D;
      color:#eeeeee;
    }
    footer div{ text-align:center; }
    footer h3{ color:#A9FF8E; font-size:16px; margin-bottom:10px; font-weight:700; }
    footer a{ color:#A9FF8E; text-decoration:none; display:block; margin:5px 0; }
    .copyright{
      text-align:center;
      font-size:12px;
      color:#eeeeee;
      background-color:#0E120D;
      padding:10px;
    }

    /* ========= MODAL ========= */
    .modal{
      display:none;
      position:fixed;
      inset:0;
      background-color:rgba(0,0,0,0.82);
      z-index:1000;
      justify-content:center;
      align-items:center;
    }

    .modal-content{
      background-color:#0E120D;
      padding:24px;
      border-radius:14px;

      width:95%;
      max-width:1400px;
      max-height:94vh;
      overflow:auto;

      position:relative;
      text-align:left;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.06);
    }

    .modal-close{
      position:absolute;
      top:10px;
      right:12px;
      color:#A9FF8E;
      font-size:30px;
      cursor:pointer;
      user-select:none;
      line-height:1;
    }

    /* Верх: малюнак злева */
    .modal-top{
      display:flex;
      align-items:flex-start;
      gap:24px;
    }

    .game-img{
      width:clamp(260px, 28vw, 380px);
      height:auto;
      border-radius:14px;
      flex:0 0 auto;
      border: 1px solid rgba(255,255,255,0.08);
    }

    .modal-side{
      flex:1;
      min-width:320px;
      display:flex;
      flex-direction:column;
    }

    /* Назва + значкі крам */
    .modal-title-row{
      display:flex;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
      margin:0 0 10px 0;
    }

    .modal-title{
      margin:0;
      font-size:28px;
      color:#A9FF8E;
      font-weight:700;
    }

    .store-icons{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .store-icon{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width:36px;
      height:36px;
      border-radius:12px;
      border: 1px solid rgba(169,255,142,0.25);
      background: rgba(0,0,0,0.18);
      color:#A9FF8E;
      text-decoration:none;
      font-weight:700;
      font-size:12px;
      line-height:1;
      transition: transform 0.15s ease, filter 0.15s ease, border-color 0.15s ease;
      user-select:none;
    }
    .store-icon:hover{
      transform: translateY(-1px);
      filter: brightness(1.08);
      border-color: rgba(169,255,142,0.45);
    }
    .store-icon:focus{
      outline:none;
      box-shadow: 0 0 0 3px rgba(169,255,142,0.18);
    }

    /* Унутры справа: 2 слупкі (усталяванне + мета) */
    .modal-side-row{
      display:flex;
      gap:22px;
      align-items:flex-start;
      justify-content:center;     /* цэнтруем абодва блокі як групу */
    }

    /* каб блок з усталяваннем не цягнуўся на ўсю шырыню */
    .modal-actions{
      flex:0 1 520px;
      min-width:340px;
    }

    .modal-screenshots-title{
      color:#A9FF8E;
      font-size:18px;
      margin:0 0 10px 0;
      font-weight:700;
    }

    .modal-platform-title{
      color:#A9FF8E;
      font-size:16px;
      margin:14px 0 8px 0;
      font-weight:700;
    }

    .modal-download-buttons{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }

    /* Мета як “бэйджы” */
    .modal-meta{
      flex:0 1 360px;
      padding:14px;
      border: 1px solid rgba(169,255,142,0.18);
      border-radius:14px;
      background: rgba(255,255,255,0.03);
    }

    .meta-title{
      margin:0 0 12px 0;
      color:#A9FF8E;
      font-weight:700;
      font-size:16px;
    }

    .meta-grid{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }

    .meta-badge{
      display:flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border: 1px solid rgba(169,255,142,0.25);
      background: rgba(0,0,0,0.18);
      max-width:100%;
    }

    .meta-badge .k{
      color:#A9FF8E;
      font-weight:700;
      font-size:11px;
      letter-spacing:0.06em;
      text-transform:uppercase;
      white-space:nowrap;
      opacity:0.95;
    }

    .meta-badge .v{
      color:#eeeeee;
      font-weight:700;
      font-size:13px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      max-width:260px;
    }

    .meta-badge.words .v{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      letter-spacing:0.02em;
    }

    /* Апісанне */
    .modal-description{
      margin:10px 0 0 0;
      font-size:14px;
      line-height:1.6;
      color:#eeeeee;
    }

    /* Скрыншоты: ВЯЛІКАЯ вобласць */
    .modal-screenshots{ margin-top:28px; }
    .carousel{ position:relative; }

    .modal-screenshot-container{
      display:flex;
      gap:16px;
      overflow-x:auto;
      overflow-y:hidden;
      scroll-behavior:smooth;
      padding:18px 90px;
      -webkit-overflow-scrolling:touch;
      scroll-snap-type:x mandatory;
    }

    .modal-screenshot{
      width:clamp(420px, 48vw, 820px);
      height:420px;
      object-fit:cover;
      border-radius:14px;
      transition:transform 0.25s ease;
      flex:0 0 auto;
      scroll-snap-align:center;
      cursor:pointer;
      user-select:none;
      border: 1px solid rgba(255,255,255,0.08);
    }

    .modal-screenshot.active{ transform:scale(1.08); }

    .prev, .next{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      background:rgba(0,0,0,0.55);
      color:white;
      border:none;
      padding:12px 14px;
      cursor:pointer;
      z-index:2;
      border-radius:12px;
      user-select:none;
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
    }
    .prev{ left:10px; }
    .next{ right:10px; }

    .game-section-blur{ filter:blur(5px); }
    body.modal-open{ overflow:hidden; }

    /* Mobile */
    @media (max-width: 980px){
      .modal-top{ flex-direction:column; }
      .modal-side{ min-width:unset; }
      .game-img{ width:min(100%, 520px); }

      .modal-side-row{ flex-direction:column; justify-content:flex-start; }
      .modal-actions{ flex:unset; width:100%; min-width:unset; }
      .modal-meta{ flex:unset; width:100%; }
      .meta-badge .v{ max-width:100%; }

      .modal-screenshot{
        width:clamp(280px, 78vw, 620px);
        height:320px;
      }
      .modal-screenshot-container{ padding:16px 70px; }
    }
  </style>
</head>

<body>
  <div class="top-bar">
    <div class="logo">łokar</div>
    <nav>
      <a href="https://www.patreon.com/c/lokar_lak" target="_blank" rel="noopener noreferrer">падтрымаць</a>
      <a href="#">гульні</a>
      <a href="#">пераклады</a>
    </nav>
  </div>

  <div class="header-container">
    <div class="header-alignment">
      <div class="header-left">
        <h1 class="main-title">Пра нас</h1>
        <p class="subtitle">
          Мы — каманда лакізатараў-энтузіастаў і проста аматараў якасных кампутарных гульняў.
          Мы робім гульні больш даступнымі, і даём адчуць самы смак беларускай у вашых улюбленых праектах.
        </p>
      </div>

      <div class="header-right">
        <span>Бягучы праект</span>
        <div class="game-name">Don't Starve Together</div>
        <a href="https://forms.gle/NWaErzdBpwZfXLNM6" target="_blank" rel="noopener noreferrer" class="game-button">Далучыцца</a>
      </div>
    </div>
  </div>

  <div class="game-section">
    <!-- Stardew Valley -->
    <div class="game-card"
      onclick="openModal(
        'Stardew Valley',
        'images/stardewValley_img.png',
        'Вы сталі спадкаемцам старой дзялянкі вашага дзеда ў даліне Стардзю. Узброіўшыся базавымі інструментамі і парай манет у кішэні, вы пачынаеце новае жыццё. Ці навучыцеся вы жыць з зямлі-карміліцы і ці стануць гэтыя зарослыя палі вашым новым квітучым домам?',
        [
          { platform: 'PC версія', links: [{ text: 'Nexus', url: '#' }, { text: 'Mega', url: '#' }] },
          { platform: 'Android версія', links: [{ text: 'Nexus', url: '#' }, { text: 'Mega', url: '#' }] }
        ],
        [
          'images/stardew/27171-1724275394-18024899.webp',
          'images/stardew/27171-1725316923-1440891159.webp',
          'images/stardew/27171-1734469877-305258919.webp',
          'images/stardew/27171-1731440227-215258228.webp',
          'images/stardew/27171-1731440220-1343818195.webp',
          'images/stardew/27171-1724275398-1615238029.webp',
          'images/stardew/27171-1724275400-1209489487.webp',
          'images/stardew/27171-1724275394-1348653713.webp',
          'images/stardew/27171-1732560547-1826579576.webp',
          'images/stardew/27171-1732560547-1540111734.webp'
        ],
        { steam: 'https://store.steampowered.com/app/413150/Stardew_Valley/', gog: 'https://www.gog.com/game/stardew_valley' },
        { developer: 'ConcernedApe', genre: 'Farming / RPG', translators: 'łokar', words: '—' }
      )">
      <img src="images/stardewValley_img.png" alt="Stardew Valley">
      <div class="game-info">
        <h2 class="game-title">Stardew Valley</h2>
        <div class="game-platforms">pc · android · клясычны і афіцыйны правапісы</div>
        <p class="game-desc">
          Вы сталі спадкаемцам старой дзялянкі вашага дзеда ў даліне Стардзю. Узброіўшыся базавымі інструментамі...
        </p>
      </div>
      <div class="button-container"><a href="#" class="game-button">Падрабязней</a></div>
    </div>

    <!-- Mouthwashing -->
    <div class="game-card"
      onclick="openModal(
        'Mouthwashing',
        'images/mouthwashing_img.png',
        'Экіпаж з пяцярых асоб на караблі «Тульпар» захрас у пустэльных прасторах космасу, ахутаны бясконцым змрокам.<br><br>І бог іх не пільнуе.',
        [
          { platform: 'PC версія', links: [{ text: 'Nexus', url: '#' }, { text: 'Mega', url: '#' }] }
        ],
        [
          'images/mouthwashing_screenshot1.webp',
          'images/mouthwashing_screenshot2.webp'
        ],
        { steam: null, gog: null },
        { developer: '—', genre: '—', translators: '—', words: '—' }
      )">
      <img src="images/mouthwashing_img.png" alt="Mouthwashing">
      <div class="game-info">
        <h2 class="game-title">Mouthwashing</h2>
        <div class="game-platforms">pc · афіцыйны правапіс</div>
        <p class="game-desc">
          Экіпаж з пяцярых асоб на караблі «Тульпар» захрас у пустэльных прасторах космасу, ахутаны бясконцым змрокам.<br><br>І бог іх не пільнуе.
        </p>
      </div>
      <div class="button-container"><a href="#" class="game-button">Падрабязней</a></div>
    </div>

    <!-- Heroes of Might & Magic 3 -->
    <div class="game-card"
      onclick="openModal(
        'Heroes of Might &amp; Magic 3',
        'images/HOMM3_img.png',
        'Пакрокавая стратэгічная гульня, распрацаваная Джонам ван Канэгемам з New World Computing пад Microsoft Windows і выпушчаная The 3DO Company у 1999 годзе. Як вынікае з назвы, гэта трэцяя гульня серыі «Heroes of Might and Magic».',
        [
          { platform: 'PC версія', links: [{ text: 'Nexus', url: '#' }, { text: 'Mega', url: '#' }] }
        ],
        [
          'images/homm3_screenshot1.png',
          'images/homm3_screenshot2.png'
        ],
        { steam: null, gog: null },
        { developer: 'New World Computing', genre: 'Пакрокавая стратэгія', translators: '—', words: '—' }
      )">
      <img src="images/HOMM3_img.png" alt="Heroes of Might & Magic 3">
      <div class="game-info">
        <h2 class="game-title">Heroes of Might & Magic 3</h2>
        <div class="game-platforms">pc · афіцыйны правапіс</div>
        <p class="game-desc">
          Пакрокавая стратэгічная гульня, распрацаваная Джонам ван Канэгемам з New World Computing пад Microsoft Windows і выпушчаная The 3DO Company у 1999 годзе...
        </p>
      </div>
      <div class="button-container"><a href="#" class="game-button">Падрабязней</a></div>
    </div>

    <!-- Valheim -->
    <div class="game-card"
      onclick="openModal(
        'Valheim',
        'images/valheim_img.png',
        'Cімулятар выжывання ў адкрытым свеце, створаны швецкай студыяй Iron Gate Studio і выдадзены кампаніяй Coffee Stain Studios. Гульня выйшла ў ранні доступ 2 лютага 2021 г. для платформ Linux і Steam, а 14 сакавіка 2023 г. для Xbox One і Xbox Series X/S.',
        [
          { platform: 'PC версія', links: [{ text: 'Nexus', url: '#' }, { text: 'Mega', url: '#' }] }
        ],
        [
          'images/valheim_screenshot1.png',
          'images/valheim_screenshot2.png'
        ],
        { steam: 'https://store.steampowered.com/app/892970/Valheim/', gog: null },
        { developer: 'Iron Gate Studio', genre: 'Survival / Open World', translators: '—', words: '—' }
      )">
      <img src="images/valheim_img.png" alt="Valheim">
      <div class="game-info">
        <h2 class="game-title">Valheim</h2>
        <div class="game-platforms">pc · афіцыйны правапіс</div>
        <p class="game-desc">
          Cімулятар выжывання ў адкрытым свеце, створаны швецкай студыяй Iron Gate Studio і выдадзены кампаніяй Coffee Stain Studios...
        </p>
      </div>
      <div class="button-container"><a href="#" class="game-button">Падрабязней</a></div>
    </div>
  </div>

  <footer>
    <div>
      <h3>падтрымаць нас</h3>
      <a href="https://www.patreon.com/c/lokar_lak" target="_blank" rel="noopener noreferrer">Patreon</a>
      <a href="https://boosty.to/lokar_lak" target="_blank" rel="noopener noreferrer">Boosty</a>
    </div>
    <div>
      <h3>далучыцца</h3>
      <a href="https://forms.gle/NWaErzdBpwZfXLNM6" target="_blank" rel="noopener noreferrer">Google Forms</a>
    </div>
    <div>
      <h3>нашы сацсеткі</h3>
      <a href="https://x.com/lokar_lak" target="_blank" rel="noopener noreferrer">Twitter</a>
      <a href="https://t.me/lokar_lak" target="_blank" rel="noopener noreferrer">Telegram</a>
      <a href="https://discord.com/invite/wCPEK5kFUj" target="_blank" rel="noopener noreferrer">Discord</a>
    </div>
  </footer>

  <p class="copyright">© 2025 - łokar</p>

  <!-- MODAL -->
  <div id="modal" class="modal" aria-hidden="true">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal()" aria-label="Закрыць">×</span>

      <div class="modal-top">
        <img id="modal-image" class="game-img" src="" alt="Game Image">

        <div class="modal-side">
          <div class="modal-title-row">
            <h2 id="modal-title" class="modal-title"></h2>
            <div id="modal-store-icons" class="store-icons" aria-label="Крамы"></div>
          </div>

          <div class="modal-side-row">
            <!-- Усталяванне -->
            <div class="modal-actions">
              <div id="modal-platforms" class="modal-platforms">
                <h3 class="modal-screenshots-title">Файлы для спампоўвання</h3>
              </div>
            </div>

            <!-- Мета (бэйджы) -->
            <div class="modal-meta">
              <div class="meta-title">Інфармацыя</div>
              <div id="meta-grid" class="meta-grid"></div>
            </div>
          </div>
        </div>
      </div>

      <h3 class="modal-screenshots-title" style="margin-top:18px;">Апісанне</h3>
      <p id="modal-description" class="modal-description"></p>

      <div id="modal-screenshots" class="modal-screenshots">
        <h3 class="modal-screenshots-title">скрыншоты</h3>
        <div class="carousel">
          <button type="button" class="prev" onclick="scrollCarousel(-1)" aria-label="Папярэдні скрыншот">&lt;</button>
          <div id="screenshot-container" class="modal-screenshot-container"></div>
          <button type="button" class="next" onclick="scrollCarousel(1)" aria-label="Наступны скрыншот">&gt;</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let debounceTimer;

    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modal-title');
    const modalImage = document.getElementById('modal-image');
    const modalDescription = document.getElementById('modal-description');
    const modalPlatforms = document.getElementById('modal-platforms');
    const modalScreenshots = document.getElementById('modal-screenshots');
    const screenshotContainer = document.getElementById('screenshot-container');
    const storeIconsEl = document.getElementById('modal-store-icons');

    const metaGrid = document.getElementById('meta-grid');

    const gameSection = document.querySelector('.game-section');
    const body = document.body;

    // не скакаць на # пры кліку на "Падрабязней"
    document.querySelectorAll('.game-card a.game-button').forEach(a => {
      a.addEventListener('click', (e) => e.preventDefault());
    });

    // закрыць па кліку на фон
    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeModal();
    });

    // Esc + стрэлкі
    document.addEventListener('keydown', (e) => {
      if (modal.style.display !== 'flex') return;
      if (e.key === 'Escape') closeModal();
      if (e.key === 'ArrowLeft') scrollCarousel(-1);
      if (e.key === 'ArrowRight') scrollCarousel(1);
    });

    // scroll listener адзін раз
    screenshotContainer.addEventListener('scroll', () => {
      clearTimeout(debounceTimer);
      debounceTimer = setTimeout(updateActiveScreenshot, 80);
    }, { passive: true });

    function renderStoreIcons(stores) {
      storeIconsEl.innerHTML = '';

      const entries = [
        { label: 'Steam', short: 'S', url: stores?.steam || null },
        { label: 'GOG',   short: 'G', url: stores?.gog   || null },
      ].filter(x => x.url);

      if (entries.length === 0) {
        storeIconsEl.style.display = 'none';
        return;
      }

      storeIconsEl.style.display = 'flex';

      entries.forEach(item => {
        const a = document.createElement('a');
        a.className = 'store-icon';
        a.href = item.url;
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        a.title = item.label;
        a.setAttribute('aria-label', item.label);

        a.textContent = item.short;
        storeIconsEl.appendChild(a);
      });
    }

    function renderMetaBadges(meta) {
      metaGrid.innerHTML = '';

      const items = [
        { key: 'Распрацоўшчык', value: meta?.developer ?? '—' },
        { key: 'Жанр', value: meta?.genre ?? '—' },
        { key: 'Аўтары', value: meta?.translators ?? '—' },
        { key: 'Слоў', value: meta?.words ?? '—', cls: 'words' },
      ];

      items.forEach(item => {
        const badge = document.createElement('div');
        badge.className = 'meta-badge' + (item.cls ? (' ' + item.cls) : '');

        const k = document.createElement('span');
        k.className = 'k';
        k.textContent = item.key;

        const v = document.createElement('span');
        v.className = 'v';
        v.textContent = String(item.value);

        badge.appendChild(k);
        badge.appendChild(v);
        metaGrid.appendChild(badge);
      });
    }

    function openModal(title, imageSrc, description, platforms, screenshots, stores, meta) {
      // reset
      modalPlatforms.innerHTML = '<h3 class="modal-screenshots-title">Файлы для спампоўвання</h3>';
      screenshotContainer.innerHTML = '';
      metaGrid.innerHTML = '';

      modalTitle.textContent = title;
      modalImage.src = imageSrc;
      modalDescription.innerHTML = description;

      renderStoreIcons(stores || {});
      renderMetaBadges(meta || {});

      // platforms
      (platforms || []).forEach(platform => {
        const platformDiv = document.createElement('div');

        const platformTitle = document.createElement('div');
        platformTitle.classList.add('modal-platform-title');
        platformTitle.textContent = platform.platform;
        platformDiv.appendChild(platformTitle);

        const buttonsDiv = document.createElement('div');
        buttonsDiv.classList.add('modal-download-buttons');

        (platform.links || []).forEach(link => {
          const a = document.createElement('a');
          a.href = link.url;
          a.classList.add('game-button');
          a.textContent = link.text;
          a.target = "_blank";
          a.rel = "noopener noreferrer";
          buttonsDiv.appendChild(a);
        });

        platformDiv.appendChild(buttonsDiv);
        modalPlatforms.appendChild(platformDiv);
      });

      // screenshots
      if (Array.isArray(screenshots) && screenshots.length > 0) {
        modalScreenshots.style.display = 'block';

        screenshots.forEach(src => {
          const img = document.createElement('img');
          img.src = src;
          img.classList.add('modal-screenshot');
          img.alt = 'Screenshot';

          // “як у Steam”: клік -> цэнтраванне + active
          img.addEventListener('click', () => centerOnImage(img, true));

          screenshotContainer.appendChild(img);
        });

        requestAnimationFrame(() => {
          const imgs = getImages();
          const mid = Math.floor(imgs.length / 2);
          centerOnIndex(mid, false);
          updateActiveScreenshot();
        });
      } else {
        modalScreenshots.style.display = 'none';
      }

      modal.style.display = 'flex';
      modal.setAttribute('aria-hidden', 'false');
      gameSection.classList.add('game-section-blur');
      body.classList.add('modal-open');
    }

    function closeModal() {
      modal.style.display = 'none';
      modal.setAttribute('aria-hidden', 'true');
      gameSection.classList.remove('game-section-blur');
      body.classList.remove('modal-open');
    }

    function getImages() {
      return Array.from(screenshotContainer.querySelectorAll('.modal-screenshot'));
    }

    function clamp(n, min, max) {
      return Math.max(min, Math.min(max, n));
    }

    function setActive(img) {
      getImages().forEach(i => i.classList.remove('active'));
      if (img) img.classList.add('active');
    }

    function centerOnImage(img, smooth = true) {
      if (!img) return;

      const targetLeft =
        img.offsetLeft + (img.clientWidth / 2) - (screenshotContainer.clientWidth / 2);

      screenshotContainer.scrollTo({
        left: Math.max(0, targetLeft),
        behavior: smooth ? 'smooth' : 'auto'
      });

      setActive(img);
    }

    function centerOnIndex(index, smooth = true) {
      const imgs = getImages();
      const img = imgs[index];
      if (!img) return;
      centerOnImage(img, smooth);
    }

    function getClosestToCenter() {
      const imgs = getImages();
      if (!imgs.length) return { img: null, index: -1 };

      const center = screenshotContainer.scrollLeft + screenshotContainer.clientWidth / 2;

      let bestIdx = 0;
      let bestDiff = Infinity;

      imgs.forEach((img, idx) => {
        const imgCenter = img.offsetLeft + img.clientWidth / 2;
        const diff = Math.abs(center - imgCenter);
        if (diff < bestDiff) {
          bestDiff = diff;
          bestIdx = idx;
        }
      });

      return { img: imgs[bestIdx], index: bestIdx };
    }

    function scrollCarousel(dir) {
      const imgs = getImages();
      if (!imgs.length) return;

      const { index } = getClosestToCenter();
      const nextIndex = clamp(index + dir, 0, imgs.length - 1);
      centerOnIndex(nextIndex, true);
    }

    function updateActiveScreenshot() {
      const { img } = getClosestToCenter();
      setActive(img);
    }
  </script>
</body>
</html>
